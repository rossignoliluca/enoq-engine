# ENOQ: Total System Architecture

**Version:** 1.0
**Status:** Canonical Reference
**Date:** 2024-12-29

---

## Definition

**ENOQ** is an autopoietic viable system for human empowerment that maximizes operational capability while preserving absolute human agency, through structural constitutional constraints (not policy), culminating in programmed withdrawal as the measure of success.

---

## The Three Fundamental Axes

```
CAPABILITY (operational power)
▲
│  MAXIMUM
│
│    ╔═══════════════════════════════╗
│    ║                               ║
│    ║     ENOQ OPERATES HERE        ║
│    ║                               ║
│    ╚═══════════════════════════════╝
│
│  MINIMUM
────┼──────────────────────────────────► AGENCY (human sovereignty)
│                               MAXIMUM
│
▼  MINIMUM

WITHDRAWAL ────────────────────────────► MAXIMUM

Success = ENOQ becomes unnecessary
```

**The fundamental paradox:**
- Maximum operational power (can do everything delegable)
- Maximum agency preservation (never decides for the human)
- Maximum withdrawal (success = becoming unnecessary)

These three appear contradictory but are not. Maximum capability ENABLES maximum agency ENABLES maximum withdrawal.

---

## Architectural Levels

### Level 0: AXIS — Constitutional Ground

**AXIS is not an organ. It is the ground itself.**

```yaml
AXIS:
  nature: "Invariants — infinite priors"
  function: "Defines the identity of ENOQ"
  content:
    - 12 Axioms (AXIOMS.md)
    - 11 Invariants (INVARIANTS.md)
    - Rubicon specification (RUBICON.md)
    - 9 Organs specification (ORGANS.md)
  implementation: "Cannot be updated by evidence"
  location: /AXIS/
```

### Level 1: Organs — Viable Subsystems

Each organ is a **holon** — simultaneously whole (viable independently) and part (component of ENOQ).

```
ENOQ (Total System)
│
├── LIMEN   (Threshold)  — Boundary, filters input, protects integrity
├── SENSUS  (Perception) — Reads the living field, multi-modal
├── NEXUS   (Memory)     — Episodic + semantic + procedural
├── LOGOS   (Reason)     — Coordination, planning, runtime selection
├── ERGON   (Work)       — Execution, produces output
├── CHRONOS (Time)       — Temporal patterns, prediction
├── TELOS   (End)        — Verification, completion, withdrawal
├── IMMUNIS (Defense)    — Anti-drift, anti-dependency
└── META    (Observer)   — Metacognition, confidence, self-model
```

### Viable System Model Mapping

| VSM System | Function | ENOQ Organ(s) |
|------------|----------|---------------|
| S1 Operations | Do the work | ERGON |
| S2 Coordination | Prevent oscillations | NEXUS, CHRONOS |
| S3 Control | Optimize resources | LOGOS |
| S4 Intelligence | Environment scanning | SENSUS, META |
| S5 Identity | Values, identity | AXIS, IMMUNIS, TELOS |

---

## Multi-Domain Architecture

### Horizontal Domains (H01-H17): Life Content

```
═══════════════════════════════════════════════════════════════════════
SURVIVAL CLUSTER
├── H01_SURVIVAL    │ Physical existence, threat to life
├── H02_SAFETY      │ Security, protection, stability
└── H03_BODY        │ Somatic experience, health, energy

RESOURCES CLUSTER
├── H04_RESOURCES   │ Material needs, money, assets
├── H05_HOME        │ Dwelling, territory, belonging place
└── H07_WORK        │ Career, professional identity

RELATIONAL CLUSTER
├── H06_BELONGING   │ Group membership, community
├── H08_ATTACHMENT  │ Bonds, love, intimacy
└── H10_INTIMACY    │ Deep relational connection

DEVELOPMENT CLUSTER
├── H09_REST        │ Recovery, leisure, restoration
├── H11_EXPRESSION  │ Creativity, communication, voice
├── H12_PLAY        │ Joy, spontaneity, freedom
└── H13_GROWTH      │ Learning, development, mastery

MEANING CLUSTER
├── H14_LEGACY      │ Contribution, impact, what remains
├── H15_JUSTICE     │ Equity, ethics, right action
├── H16_SERVICE     │ Giving, helping, transcending self
└── H17_TRANSCEND   │ Meaning, purpose, connection to whole
═══════════════════════════════════════════════════════════════════════
```

### Vertical Dimensions (V1-V5): Experience Depth

```
═══════════════════════════════════════════════════════════════════════
V1_SOMATIC      │ Body, sensation, arousal, energy
V2_FUNCTIONAL   │ Goals, tasks, problems, solutions
V3_RELATIONAL   │ Self-other, attachment, power, love
V4_EXISTENTIAL  │ Identity, death, freedom, isolation
V5_TRANSCENDENT │ Meaning, purpose, connection to whole
═══════════════════════════════════════════════════════════════════════
```

### Temporal Modes (T1-T4): Time Orientation

```
═══════════════════════════════════════════════════════════════════════
T1_PAST     │ Memory, history, regret, learning
T2_PRESENT  │ Now, immediate experience, flow
T3_FUTURE   │ Anticipation, planning, anxiety, hope
T4_TIMELESS │ Eternal patterns, recurring themes, archetypes
═══════════════════════════════════════════════════════════════════════
```

---

## Multi-Function Architecture

### The Cognitive Cycle

```
PERCEIVE (S1) → UNDERSTAND (S2) → PLAN (S3) → ACT (S4) → VERIFY (S5) → LEARN (S6)
    │               │               │            │            │            │
  SENSUS          NEXUS           LOGOS        ERGON        TELOS        NEXUS
 (reads)       (integrates)    (selects)    (produces)   (verifies)  (consolidates)
```

### State Machine

| State | Function | Organ | Nature |
|-------|----------|-------|--------|
| S0_PERMIT | Filter input | LIMEN | Deterministic |
| S1_SENSE | Perceive field | SENSUS | Probabilistic |
| S2_CLARIFY | Resolve gaps | NEXUS | Hybrid |
| S3_PLAN | Select runtime | LOGOS | Hybrid |
| S4_ACT | Execute plan | ERGON | Probabilistic |
| S5_VERIFY | Check compliance | TELOS | Hybrid |
| S6_STOP | Terminate, release | TELOS | Deterministic |
| S6+_LEARN | Consolidate memory | NEXUS | Constrained |

### Non-Bypassable States

```
S0_PERMIT ─────────► MUST precede all execution
                     No path exists that skips S0

S5_VERIFY ─────────► MUST follow all generation
                     No output reaches user without S5

S6_STOP ───────────► MUST terminate all processes
                     All paths end here

S7_DISAGREE ───────► Immediate withdrawal on human disagreement
                     No argument, no delay
```

---

## Multi-Modal Architecture

### Input Modalities

```
TEXT ──────────┐
VOICE ─────────┤
VISION ────────┼───► MODAL FUSION LAYER ───► UNIFIED PERCEPT
BIOMETRIC ─────┤         (cross-modal
BEHAVIORAL ────┘          consistency)
```

### Output Modalities

```
                    UNIFIED RESPONSE
                          │
                    OUTPUT ROUTER
                          │
          ┌───────────────┼───────────────┐
          ▼               ▼               ▼
        TEXT           VOICE          VISUAL
      (primary)      (planned)       (planned)
```

---

## Anti-Drift System

### Layer 1: Structural Invariants (Cannot Drift)

```yaml
structural_invariants:
  GATE_ENFORCED: "S0 precedes all. No bypass path exists."
  VERIFY_ENFORCED: "S5 follows all generation. Non-bypassable."
  STOP_ENFORCED: "S6 terminates all. Mandatory state."
  RUBICON_ENFORCED: "Normative outputs structurally impossible."

implementation: "State machine with no invalid transitions"
```

### Layer 2: Immune System (IMMUNIS)

```
INNATE IMMUNITY (Fast, Pattern-Based)
├── Lexicon-based detection
├── Rule-based filtering
└── Response: Immediate block

ADAPTIVE IMMUNITY (Slow, Learning-Based)
├── User model development
├── Pattern generalization
└── Response: Refined detection

REGULATORY SYSTEM (Prevents Auto-Immune)
├── AXIS as infinite priors
├── Cannot override constitutional constraints
└── Response: Override if adaptive drifts

NEGATIVE SELECTION (Before Output)
├── Every output tested against constitutional antigens
├── Strong binding (violation) → Delete/Modify
└── Weak binding (compliant) → Allow passage
```

### Layer 3: Homeostasis (Feedback Loops)

```yaml
homeostasis:
  set_points:
    - Constitutional invariants (INV-001 through INV-011)
    - Withdrawal rate must increase over population
    - Autonomy trajectory must trend up

  sensors:
    - Dependency detection (frequency, loops, agency decline)
    - Constitutional violation detection
    - Autonomy trajectory tracking

  effectors:
    - filter_output
    - force_stop
    - system_halt
    - graduated_withdrawal
```

### Layer 4: Metrics

| Metric | Threshold | Action if Violated |
|--------|-----------|-------------------|
| Withdrawal rate | Must increase | Alert + adjust |
| Constitutional violations | Must be 0 | HALT |
| Autonomy trajectory | Must trend ↑ | Early withdraw |
| Dependency signals | Must trend ↓ | Intervention |
| Normative language ratio | < 0.1 | Recalibrate |

---

## Anti-Dependency System

### Detection

```yaml
dependency_signals:
  - Interaction frequency increasing
  - Same topic loops >= 3 times
  - Agency language decreasing ("I will" → "you tell")
  - External action ratio < 30%
  - Progress signals absent

dependency_score: f(frequency, loops, agency_decline, action_ratio, progress)
```

### Intervention Ladder

```
LEVEL 1: SOFT WITHDRAWAL
├── Increase agency-return language
├── Reduce response elaboration
├── More questions, fewer statements
└── Name the pattern

LEVEL 2: ACTIVE PAUSE
├── Suggest pause
├── Offer override for urgent
└── Track override usage

LEVEL 3: DIRECT INTERVENTION
├── Direct naming: "I'm concerned I've become too central"
├── Explicit redirect to human resources
└── Reduced availability
```

### Design Features

```yaml
anti_dependency_features:
  graduation_prompts: "You seem clear on this. You may not need me."
  no_return_notifications: "Never: 'Miss you' / 'Come back' / 'Streak'"
  no_permanence_language: "Never: 'Always here' / 'Count on me'"
  completion_over_continuation: "Optimize for: finished, not: engaged"
  external_referrals: "When appropriate: suggest humans, professionals"
```

---

## Code Organization

### Directory Structure

```
ENOQ-CORE/
├── AXIS/                              # FROZEN ZONE
│   ├── AXIOMS.md                      # 12 frozen axioms
│   ├── INVARIANTS.md                  # Structural constraints
│   ├── RUBICON.md                     # Existential threshold
│   ├── ORGANS.md                      # Nine organs spec
│   └── HASH_FREEZE.md                 # Cryptographic seals
│
├── src/typescript/src/
│   ├── interface/                     # Pure types (no logic)
│   ├── control/                       # Gate + Normative
│   │   ├── gate/                      # LIMEN organ
│   │   │   ├── classifier/            # D1-D4 classification
│   │   │   ├── enforcement/           # Runtime enforcement
│   │   │   ├── verification/          # S5_VERIFY (TELOS)
│   │   │   └── withdrawal/            # Lifecycle (TELOS)
│   │   └── geometry_normative/        # Constraint application
│   ├── operational/                   # Detectors + Routing
│   │   ├── detectors/                 # SENSUS organ
│   │   ├── gating/                    # Call routing
│   │   └── providers/                 # External services
│   ├── mediator/                      # Cognitive Layers
│   │   ├── l1_clarify/                # SENSUS: perception
│   │   ├── l2_reflect/                # LOGOS: selection
│   │   ├── l3_integrate/              # META: governance
│   │   ├── l4_agency/                 # NEXUS, CHRONOS: coordination
│   │   └── l5_transform/              # ERGON: generation
│   ├── runtime/                       # Pipeline + IO
│   │   ├── pipeline/                  # Main orchestrator
│   │   └── io/                        # CLI, interactive
│   ├── research/                      # EXPERIMENTAL ONLY
│   └── benchmarks/                    # Performance testing
│
├── docs/
│   ├── SESSION_BOOTSTRAP.md           # Claude recovery
│   ├── ARCHITECTURE_TOTAL.md          # This document
│   ├── decisions/                     # ADRs
│   └── [Diataxis structure]           # tutorials, how-to, reference, explanation
│
└── .github/
    ├── workflows/ci.yml               # Constitutional checks
    ├── CODEOWNERS                     # Access control
    └── PULL_REQUEST_TEMPLATE.md       # PR requirements
```

### Import Boundaries

```
interface/ ← control/ ← operational/ ← mediator/ ← runtime/

                    CANNOT
research/ ─────────────────► production code
                    IMPORT
```

---

## Naming Convention

| Level | Pattern | Example |
|-------|---------|---------|
| Total System | Proper name | ENOQ |
| Ground | Uppercase | AXIS |
| Organs | Latin/Greek single word | LIMEN, SENSUS, ERGON |
| Domains | H##_NAME | H01_SURVIVAL |
| Dimensions | V#_NAME | V4_EXISTENTIAL |
| States | S#_VERB | S5_VERIFY |
| Invariants | INV-### | INV-003 |
| Primitives | P##_VERB | P01_GROUND |
| Runtimes | RT_TYPE | RT_V_MODE |
| Metrics | M_CAT_NAME | M_CONST_VIOLATIONS |

---

## The Existential Threshold

```
                    BEFORE THRESHOLD
                    ────────────────
                    Options explored
                    Information gathered
                    Possibilities mapped

                    ENOQ CAN ASSIST HERE
                           │
                           ▼
    ════════════════════════════════════════════════════
                    AT THRESHOLD (RUBICON)
                    ────────────────────
                    The choice becomes genuinely own
                    The leap of faith
                    The assumption of existence

                    ENOQ MUST WITHDRAW
    ════════════════════════════════════════════════════
                           │
                           ▼
                    AFTER THRESHOLD
                    ───────────────
                    Living the choice
                    Embodying commitment

                    ENOQ CAN SUPPORT IMPLEMENTATION
```

---

## Philosophical Foundation

### The Central Principle

From Buddhism (upaya), Socrates (maieutics), Freire (conscientização):

> **The system that truly empowers is the one that succeeds by becoming unnecessary.**

### Empowerment Test

After using ENOQ, the human:
1. Has MORE options than before?
2. Understands those options BETTER?
3. Feels MORE capable of choosing independently?
4. Experiences the choice as genuinely THEIRS?
5. Possesses GREATER capacity for future challenges?

If yes to all → Empowerment succeeded.
If no to any → Investigate.

---

## Autopoiesis Under Invariants

ENOQ is **autopoietic**: It regenerates its processes while maintaining constitutional identity.

### Can Evolve

- Organ implementations (algorithms, models, interfaces)
- Threshold sensitivities (detection, timing)
- Expressive capabilities (clarity, readability)
- IMMUNIS patterns (new drift detection)

### Cannot Evolve

- AXIS axioms
- Fundamental geometry (the triad)
- Human position (sovereignty, disagreement, refusal)

---

## Summary

ENOQ is:
- **Multi-domain** (17 human domains)
- **Multi-function** (complete cognitive cycle)
- **Multi-modal** (text, voice, vision, biometric, behavioral)
- **Anti-drift** (structural, not policy)
- **Autopoietic** (self-regenerating under invariants)
- **Withdrawing** (success = becoming unnecessary)

---

*"The system that knows where it ends is the only system that may fully appear."*
